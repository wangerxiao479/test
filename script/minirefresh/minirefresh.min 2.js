/**
 * minirefresh - 优雅的H5下拉刷新。零依赖，高性能，多主题，易拓展。
 * @version v0.0.7
 * @author dailc(dailichun@aliyun.com)
 * https://github.com/minirefresh/minirefresh
 */
!function(o,t){"use strict";var n=o.MiniRefreshTools||t(o);"undefined"!=typeof module&&module.exports?exports.MiniRefreshTools=n:"function"==typeof define&&(define.amd||define.cmd)&&define(function(){return n}),o.MiniRefreshTools=n}("undefined"!=typeof window?window:global,function(o,t){"use strict";return t=t||{},function(){var o=!1,n=/xyz/.test(function(){"xyz"})?/\b_super\b/:/.*/,i=function(){};i.extend=function(t){function i(){!o&&this.init&&this.init.apply(this,arguments)}var s=this.prototype;o=!0;var e=new this;o=!1;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]="function"==typeof t[r]&&"function"==typeof s[r]&&n.test(t[r])?function(o,t){return function(){var n=this._super;this._super=s[o];var i=t.apply(this,arguments);return this._super=n,i}}(r,t[r]):t[r]);return i.prototype=e,i.prototype.constructor=i,i.extend=this.extend,i},t.Clazz=i}(),t.noop=function(){},t.isFunction=function(o){return"function"==typeof o},t.isObject=function(o){return"object"==typeof o},t.isArray=Array.isArray||function(o){return o instanceof Array},t.extend=function(){var o=[].slice.call(arguments),n=o[0]||{},i=1,s=o.length,e=!1;for("boolean"==typeof n&&(e=n,n=o[i]||{},i++),t.isObject(n)||(n={});i<s;i++){var r=o[i];if(r&&t.isObject(r))for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)){var p,l,c=n[a],d=r[a];n!==d&&(e&&d&&(t.isObject(d)||(l=t.isArray(d)))?(l?(l=!1,p=c&&t.isArray(c)?c:[]):p=c&&t.isObject(c)?c:{},n[a]=t.extend(e,p,d)):void 0!==d&&(n[a]=d))}}return n},t.selector=function(o){return"string"==typeof o&&(o=document.querySelector(o)),o},t.namespace=function(t,n){var i=o.MiniRefreshTools;if(!t)return i;for(var s=t.split("."),e=s.length,r=0;r<e-1;r++){var a=s[r];i[a]=i[a]||{},i=i[a]}return i[s[e-1]]=n,i[s[e-1]]},t}),function(o){var t=1e3,n=60,i=t/n,s="scroll",e="pull",r="upLoading",a="downLoading",p="cancelLoading",l="beforeDownLoading",c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(o){window.setTimeout(o,i)},d=function(o){this.minirefresh=o,this.container=o.container,this.scrollWrap=o.scrollWrap,this.options=o.options,this.events={},this.hooks={},this.isScrollTo=!1,this.upLoading=!1,this.downLoading=!1,this.isLockDown=!1,this.isLockUp=!1,this.isFinishUp=!1,!this.options.down&&(this.isLockDown=!0),!this.options.up&&(this.isLockUp=!0),this._initPullDown(),this._initPullUp();var t=this;setTimeout(function(){t.options.down&&t.options.down.isAuto&&!t.isLockDown?t.options.down.isAllowAutoLoading?t.triggerDownLoading():t.events[a]&&t.events[a](!0):t.options.up&&t.options.up.isAuto&&!t.isLockUp&&t.triggerUpLoading()})};d.prototype.refreshOptions=function(o){this.options=o},d.prototype.translateScrollWrap=function(o,t){this._translate(o,t),this.downHight=o},d.prototype._translate=function(o,t){if(this.options.down.isScrollCssTranslate){o=o||0,t=t||0;var n=this.scrollWrap;n.style.webkitTransitionDuration=t+"ms",n.style.transitionDuration=t+"ms",n.style.webkitTransform="translate(0px, "+o+"px) translateZ(0px)",n.style.transform="translate(0px, "+o+"px) translateZ(0px)"}},d.prototype._initPullDown=function(){var o=this,t=this.scrollWrap;t.webkitTransitionTimingFunction="cubic-bezier(0.1, 0.57, 0.1, 1)",t.transitionTimingFunction="cubic-bezier(0.1, 0.57, 0.1, 1)";var n=function(n){o.isScrollTo&&n.preventDefault(),o.startTop=t.scrollTop,o.startY=n.touches?n.touches[0].pageY:n.clientY,o.startX=n.touches?n.touches[0].pageX:n.clientX};t.addEventListener("touchstart",n),t.addEventListener("mousedown",n);var i=function(n){var i=o.options,s=!0;if(o.downLoading?s=!1:!i.down.isAways&&o.upLoading&&(s=!1),void 0!==o.startTop&&o.startTop<=0&&s&&!o.isLockDown){var r=n.touches?n.touches[0].pageY:n.clientY,a=n.touches?n.touches[0].pageX:n.clientX;o.preY||(o.preY=r);var p=r-o.preY;o.preY=r;var l=r-o.startY,c=a-o.startX;if(Math.abs(c)>Math.abs(l))return void n.preventDefault();if(l>0){o.isMoveDown=!0,n.preventDefault(),o.downHight||(o.downHight=0);var d=i.down.offset;o.downHight<d?o.downHight+=p:p>0?o.downHight+=p*i.down.dampRate:o.downHight+=p,o.events[e]&&o.events[e](o.downHight,d),o._translate(o.downHight)}else t.scrollTop<=0&&(t.scrollTop+=Math.abs(p))}};t.addEventListener("touchmove",i),t.addEventListener("mousemove",i);var s=function(t){var n=o.options;o.isMoveDown&&(o.downHight>=n.down.offset?o.triggerDownLoading():(o._translate(0,n.down.bounceTime),o.downHight=0,o.events[p]&&o.events[p]()),o.isMoveDown=!1),o.startY=0,o.startX=0,o.preY=0,o.startTop=void 0};t.addEventListener("touchend",s),t.addEventListener("mouseup",s),t.addEventListener("mouseleave",s)},d.prototype._initPullUp=function(){var o=this,t=this.scrollWrap;t.addEventListener("scroll",function(){var n=t.scrollTop,i=t.scrollHeight,e=t.clientHeight,r=o.options;if(o.events[s]&&o.events[s](n),!o.upLoading&&!o.isLockUp&&!o.isFinishUp){var a=i-e-n;a<=r.up.offset&&o.triggerUpLoading()}})},d.prototype._loadFull=function(){var o=this,t=this.scrollWrap,n=this.options;setTimeout(function(){!o.isLockUp&&n.up.loadFull.isEnable&&t.scrollHeight<=t.clientHeight&&o.triggerUpLoading()},n.up.loadFull.delay||0)},d.prototype.triggerDownLoading=function(){var o=this,t=this.options,n=t.down.bounceTime;this.hooks[l]&&!this.hooks[l](o.downHight,t.down.offset)||(o.downLoading=!0,o.downHight=t.down.offset,o._translate(o.downHight,n),o.events[a]&&o.events[a]())},d.prototype.endDownLoading=function(){var o=this,t=this.options,n=t.down.bounceTime;this.downLoading&&(o._translate(0,n),o.downHight=0,o.downLoading=!1)},d.prototype.triggerUpLoading=function(){this.upLoading=!0,this.events[r]&&this.events[r]()},d.prototype.endUpLoading=function(o){this.upLoading&&(this.upLoading=!1,o?this.isFinishUp=!0:this._loadFull())},d.prototype.scrollTo=function(o,t){var n=this,s=this.scrollWrap;o=o||0,t=t||0;var e=s.scrollHeight-s.clientHeight;o=Math.max(o,0),o=Math.min(o,e);var r=s.scrollTop-o;if(0!==r){if(0===t)return void(s.scrollTop=o);var a=t/i,p=r/a,l=0;n.isScrollTo=!0;var d=function(){l<a?(l===a-1?s.scrollTop=o:s.scrollTop-=p,l++,c(d)):n.isScrollTo=!1};c(d)}},d.prototype.lockDown=function(o){this.options.down&&(this.isLockDown=o)},d.prototype.lockUp=function(o){this.options.up&&(this.isLockUp=o)},d.prototype.resetUpLoading=function(){this.isFinishUp&&(this.isFinishUp=!1);var o=document.createEvent("HTMLEvents");o.initEvent("scroll",!1,!0),this.scrollWrap.dispatchEvent(o)},d.prototype.on=function(t,n){t&&o.isFunction(n)&&(this.events[t]=n)},d.prototype.hook=function(t,n){t&&o.isFunction(n)&&(this.hooks[t]=n)},o.Scroll=d}(MiniRefreshTools),function(o){var t={down:{isLock:!1,isAuto:!1,isAllowAutoLoading:!0,isAways:!1,isScrollCssTranslate:!0,offset:75,dampRate:.3,bounceTime:300,successAnim:{isEnable:!1,duration:300},onPull:null,onCalcel:null,callback:o.noop},up:{isLock:!1,isAuto:!0,isShowUpLoading:!0,offset:100,loadFull:{isEnable:!0,delay:300},onScroll:null,callback:o.noop},container:"#minirefresh"},n=o.Clazz.extend({init:function(n){n=o.extend(!0,{},t,n),this.container=o.selector(n.container),this.scrollWrap=this.container.children[0],this.options=n,this.scroller=new o.Scroll(this),this._initEvent(),this._initHook&&this._initHook(this.scroller.isLockDown,this.scroller.isLockUp),n.up.isLock&&this._lockUpLoading(n.up.isLock),n.down.isLock&&this._lockDownLoading(n.down.isLock)},_resetOptions:function(){var o=this.options;this._lockUpLoading(o.up.isLock),this._lockDownLoading(o.down.isLock)},_initEvent:function(){var o=this,t=o.options;this.scroller.on("downLoading",function(n){!n&&o._downLoaingHook&&o._downLoaingHook(),t.down.callback&&t.down.callback()}),this.scroller.on("cancelLoading",function(){o._cancelLoaingHook&&o._cancelLoaingHook(),t.down.onCalcel&&t.down.onCalcel()}),this.scroller.on("upLoading",function(){o._upLoaingHook&&o._upLoaingHook(o.options.up.isShowUpLoading),t.up.callback&&t.up.callback()}),this.scroller.on("pull",function(n,i){o._pullHook&&o._pullHook(n,i),t.down.onPull&&t.down.onPull(n,i)}),this.scroller.on("scroll",function(n){o._scrollHook&&o._scrollHook(n),t.up.onScroll&&t.up.onScroll(n)}),this.scroller.hook("beforeDownLoading",function(t,n){return!o._beforeDownLoadingHook||o._beforeDownLoadingHook(t,n)})},_endDownLoading:function(o){var t=this;if(this.options.down&&this.scroller.downLoading){var n=this.options.down.successAnim.isEnable,i=this.options.down.successAnim.duration;n?this._downLoaingSuccessHook&&this._downLoaingSuccessHook(o):i=0,setTimeout(function(){t.scroller.endDownLoading(),t._downLoaingEndHook&&t._downLoaingEndHook(o)},i)}},_endUpLoading:function(o){this.scroller.upLoading&&(this.scroller.endUpLoading(o),this._upLoaingEndHook&&this._upLoaingEndHook(o))},_resetUpLoading:function(){this.scroller.resetUpLoading()},_lockUpLoading:function(o){this.scroller.lockUp(o),this._lockUpLoadingHook&&this._lockUpLoadingHook(o)},_lockDownLoading:function(o){this.scroller.lockDown(o),this._lockDownLoadingHook&&this._lockDownLoadingHook(o)},refreshOptions:function(t){this.options=o.extend(!0,{},this.options,t),this.scroller.refreshOptions(this.options),this._resetOptions(t),this._refreshHook&&this._refreshHook()},endDownLoading:function(o){"boolean"!=typeof o&&(o=!0),this._endDownLoading(o),this._resetUpLoading()},resetUpLoading:function(){this._resetUpLoading()},endUpLoading:function(o){this._endUpLoading(o)},triggerUpLoading:function(){this.scroller.triggerUpLoading()},triggerDownLoading:function(){this.scroller.scrollTo(0),this.scroller.triggerDownLoading()},scrollTo:function(o,t){this.scroller.scrollTo(o,t)}});o.core=n}(MiniRefreshTools),function(o,t){var n="minirefresh-theme-default",i="minirefresh-downwrap",s="minirefresh-upwrap",e="minirefresh-fade-in",r="minirefresh-fade-out",a="minirefresh-totop",p="minirefresh-rotate",l="minirefresh-hardware-speedup",c="minirefresh-hidden",d="downwrap-success",h="downwrap-error",u=75,w={down:{successAnim:{isEnable:!1,duration:300},contentdown:"下拉刷新",contentover:"释放刷新",contentrefresh:"加载中...",contentsuccess:"刷新成功",contenterror:"刷新失败",isWrapCssTranslate:!1},up:{toTop:{isEnable:!0,duration:300,offset:800},contentdown:"上拉显示更多",contentrefresh:"加载中...",contentnomore:"没有更多数据了"}},f=o.core.extend({init:function(t){t=o.extend(!0,{},w,t),this._super(t)},_initHook:function(o,t){var i=this.container,s=this.scrollWrap;i.classList.add(n),s.classList.add(l),this._initDownWrap(),this._initUpWrap(),this._initToTop()},_refreshHook:function(){this.options.down.isWrapCssTranslate?this._transformDownWrap(-this.downWrapHeight):this._transformDownWrap(0,0,!0),this.options.up.toTop.isEnable||(this.toTopBtn&&this.toTopBtn.classList.add(c),this.isShowToTopBtn=!1)},_initDownWrap:function(){var o=this.container,t=this.scrollWrap,n=this.options,s=document.createElement("div");s.className=i+" "+l,s.innerHTML='<div class="downwrap-content"><p class="downwrap-progress"></p><p class="downwrap-tips">'+n.down.contentdown+" </p></div>",o.insertBefore(s,t),this.downWrap=s,this.downWrapProgress=this.downWrap.querySelector(".downwrap-progress"),this.downWrapTips=this.downWrap.querySelector(".downwrap-tips"),this.isCanPullDown=!1,this.downWrapHeight=s.offsetHeight||u,this._transformDownWrap(-this.downWrapHeight)},_transformDownWrap:function(o,t,n){(n||this.options.down.isWrapCssTranslate)&&(o=o||0,t=t||0,this.downWrap.style.webkitTransitionDuration=t+"ms",this.downWrap.style.transitionDuration=t+"ms",this.downWrap.style.webkitTransform="translateY("+o+"px)  translateZ(0px)",this.downWrap.style.transform="translateY("+o+"px)  translateZ(0px)")},_initUpWrap:function(){var o=this.scrollWrap,t=this.options,n=document.createElement("div");n.className=s+" "+l,n.innerHTML='<p class="upwrap-progress"></p><p class="upwrap-tips">'+t.up.contentdown+"</p>",n.style.visibility="hidden",o.appendChild(n),this.upWrap=n,this.upWrapProgress=this.upWrap.querySelector(".upwrap-progress"),this.upWrapTips=this.upWrap.querySelector(".upwrap-tips")},_initToTop:function(){var o=this,t=this.options,i=t.up.toTop.isEnable,s=t.up.toTop.duration;if(i){var e=document.createElement("div");e.className=a+" "+n,e.onclick=function(){o.scroller.scrollTo(0,s)},e.classList.add(c),this.toTopBtn=e,this.isShowToTopBtn=!1,document.body.appendChild(e)}},_pullHook:function(o,t){var n=this.options,i=360;o<t?this.isCanPullDown&&(this.downWrapTips.innerText=n.down.contentdown,this.isCanPullDown=!1):this.isCanPullDown||(this.downWrapTips.innerText=n.down.contentover,this.isCanPullDown=!0);var s=o/t,e=i*s;this.downWrapProgress.style.webkitTransform="rotate("+e+"deg)",this.downWrapProgress.style.transform="rotate("+e+"deg)",this._transformDownWrap(-this.downWrapHeight+o)},_scrollHook:function(o){var t=this.options,n=t.up.toTop.isEnable,i=this.toTopBtn;n&&i&&(o>=t.up.toTop.offset?this.isShowToTopBtn||(i.classList.remove(r),i.classList.remove(c),i.classList.add(e),this.isShowToTopBtn=!0):this.isShowToTopBtn&&(i.classList.add(r),i.classList.remove(e),this.isShowToTopBtn=!1))},_downLoaingHook:function(){this._transformDownWrap(-this.downWrapHeight+this.options.down.offset,this.options.down.bounceTime),this.downWrapTips.innerText=this.options.down.contentrefresh,this.downWrapProgress.classList.add(p)},_downLoaingSuccessHook:function(o){this.downWrapTips.innerText=o?this.options.down.contentsuccess:this.options.down.contenterror,this.downWrapProgress.classList.remove(p),this.downWrapProgress.classList.add(r),this.downWrapProgress.classList.add(o?d:h)},_downLoaingEndHook:function(o){this.downWrapTips.innerText=this.options.down.contentdown,this.downWrapProgress.classList.remove(p),this.downWrapProgress.classList.remove(r),this.downWrapProgress.classList.remove(o?d:h),this.isCanPullDown=!1,this._transformDownWrap(-this.downWrapHeight,this.options.down.bounceTime)},_cancelLoaingHook:function(){this._transformDownWrap(-this.downWrapHeight,this.options.down.bounceTime)},_upLoaingHook:function(o){o?(this.upWrapTips.innerText=this.options.up.contentrefresh,this.upWrapProgress.classList.add(p),this.upWrapProgress.classList.remove(c),this.upWrap.style.visibility="visible"):this.upWrap.style.visibility="hidden"},_upLoaingEndHook:function(o){o?(this.upWrap.style.visibility="visible",this.upWrapTips.innerText=this.options.up.contentnomore):(this.upWrap.style.visibility="hidden",this.upWrapTips.innerText=this.options.up.contentdown),this.upWrapProgress.classList.remove(p),this.upWrapProgress.classList.add(c)},_lockUpLoadingHook:function(o){this.upWrap.style.visibility=o?"hidden":"visible"},_lockDownLoadingHook:function(o){this.downWrap.style.visibility=o?"hidden":"visible"}});o.namespace("theme.defaults",f),t.MiniRefresh=f}(MiniRefreshTools,"undefined"!=typeof window?window:global);